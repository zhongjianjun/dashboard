webpackJsonp([17],{596:function(e,t,n){"use strict";function InformationAdd(e){var t=e.dispatch,a=e.question,r=e.app,o={breadcrumbs:[{name:"首页"},{name:"问答管理"},{name:"新增问答"}]},s={selectChannels:r.selectChannels,selectColumns:r.selectColumns,labellist:a.labellist,uploadToken:a.uploadToken,isUpload:a.isUpload,formSureButton:a.formSureButton,channel_id:a.channel_id,column_id:a.column_id,question_author:a.question_author,title:a.title,user_img:a.user_img,intro:a.intro,answer:a.answer,is_reco:a.is_reco,sort_order:a.sort_order,changeSelectChannels:function(e){t(n.i(p.d)(e)),t(n.i(h.a)(e))},uploadImg:function(e){t(n.i(h.b)(e))},onCancel:function(){m.b.push("/question")},onOk:function(e){n.i(u.a)(function(){return t(n.i(h.e)(e))})}};return l.a.createElement("div",null,l.a.createElement(c.a,o),l.a.createElement(i.a,{className:"y-m-b-40"},l.a.createElement(d.a,s)))}Object.defineProperty(t,"__esModule",{value:!0});var a=n(606),r=(n.n(a),n(605)),i=n.n(r),o=n(0),l=n.n(o),s=n(135),u=n(246),p=(n(11),n(33)),c=n(604),m=n(28),d=n(652),h=n(139);t.default=n.i(s.a)(function(e){return{question:e.question,app:e.app}})(InformationAdd)},604:function(e,t,n){"use strict";function newBreadcrumb(e){var t=e.breadcrumbs;return l.a.createElement(i.a,{separator:">",style:{marginBottom:"20px"}},t.map(function(e,t){return l.a.createElement(i.a.Item,{key:t},u.a.isStringNotEmpty(e.href)?l.a.createElement(s.Link,{to:e.href},e.name):e.name)}))}var a=n(611),r=(n.n(a),n(610)),i=n.n(r),o=n(0),l=n.n(o),s=n(73),u=n(11);t.a=newBreadcrumb},623:function(e,t,n){"use strict";var a=n(242),r=n.n(a),i=n(30),o=n.n(i),l=n(243),s=n.n(l),u=n(32),p=n.n(u),c=n(31),m=n.n(c),d=n(0),h=n.n(d),f=n(140),g=n(625),v=(n.n(g),n(3)),_=n(637),E=(n.n(_),void 0),b=function(e){function Editor(e){o()(this,Editor);var t=p()(this,(Editor.__proto__||r()(Editor)).call(this,e));return t.state={},t}return m()(Editor,e),s()(Editor,[{key:"componentDidMount",value:function(){var e=this,t=this.props.id;E=new wangEditor(t),E.config.menus=wangEditor.config.menus.map(function(e,t){return"video"===e?null:"location"===e?null:"insertcode"===e?null:e}),E.config.uploadImgUrl=n.i(v.b)()+"/property/image/upload",E.config.withCredentials=!1,E.create();var a=E;E.$txt.html(this.props.html),E.onchange=function(){var n=a.$txt.html();e.props.handleEditor(t,n)}}},{key:"componentWillReceiveProps",value:function(e){var t=this,n=this.props.id,a=E;E.$txt.html(e.html),E.onchange=function(){var e=a.$txt.html();t.props.handleEditor(n,e)}}},{key:"render",value:function(){var e={width:"100%",height:"200px"};return h.a.createElement("div",null,h.a.createElement("div",{id:this.props.id,style:e,contentEditable:"true"}))}}]),Editor}(h.a.Component);t.a=n.i(f.connect)(function(e){return{editor:e.editor}})(b)},624:function(e,t,n){t=e.exports=n(42)(!1),t.push([e.i,"",""])},625:function(e,t,n){var a=n(624);"string"==typeof a&&(a=[[e.i,a,""]]);n(43)(a,{});a.locals&&(e.exports=a.locals)},652:function(e,t,n){"use strict";var a=n(133),r=(n.n(a),n(90)),i=n.n(r),o=n(614),l=(n.n(o),n(613)),s=n.n(l),u=n(245),p=(n.n(u),n(244)),c=n.n(p),m=n(618),d=(n.n(m),n(617)),h=n.n(d),f=n(600),g=(n.n(f),n(603)),v=n.n(g),_=n(602),E=(n.n(_),n(601)),b=n.n(E),y=n(1),C=n.n(y),k=n(608),w=(n.n(k),n(607)),I=n.n(w),q=n(134),S=(n.n(q),n(44)),F=n.n(S),x=n(14),U=(n.n(x),n(13)),V=n.n(U),A=n(242),D=n.n(A),P=n(30),B=n.n(P),j=n(243),L=n.n(j),O=n(32),T=n.n(O),$=n(31),M=n.n($),N=n(0),z=n.n(N),R=(n(139),n(623)),W="",G=function(e){function InformationAdd(e){B()(this,InformationAdd);var t=T()(this,(InformationAdd.__proto__||D()(InformationAdd)).call(this,e));return t.state={name:"",file:"",previewImage:"",previewVisible:!1,isUpload:!0},t.props.img_url,W=t.props.answer,t}return M()(InformationAdd,e),L()(InformationAdd,[{key:"componentDidMount",value:function(){console.log("isUpload",this.state.isUpload)}},{key:"componentWillReceiveProps",value:function(e){this.props.answer!=e.answer&&(W=e.answer)}},{key:"handleSubmit",value:function(){var e=this;this.props.form.validateFields(function(t,n){if(!t){var a="";0!=n.user_img.length&&(void 0!=n.user_img[0].response?a=n.user_img[0].response.data.imgPath+n.user_img[0].response.data.message:""!=n.user_img&&(a=n.user_img[0].url));var r=e.props.id,i="";W=W.replace(new RegExp("<p><br></p>"),""),i=W,e.props.onOk({id:r,channel_id:n.channel_id,column_id:n.column_id,question_author:n.question_author,user_img:a,intro:n.intro,answer:i,is_reco:n.is_reco,sort_order:n.sort_order},e.props.form.resetFields)}})}},{key:"handleCancel",value:function(){this.props.onCancel(),this.props.form.resetFields(),this.setState({isUpload:!0})}},{key:"handlePreview",value:function(e){this.setState({previewImage:e.url||e.thumbUrl,previewVisible:!0})}},{key:"beforeUpload",value:function(e){var t="image/jpeg"===e.type,n="image/png"===e.type;if("image/jpg"!==e.type&&!t&&!n)return V.a.error("只能上传.jpeg,.jpg,.png图片"),!1;if(!(e.size/1024/1024<2))return V.a.error("请上传小于 2MB 的图片!"),!1;var a=(new Date).getTime(),r=e.type.split("/");this.setState({name:"jiazhuanghoutai/"+a+"."+r[1],files:e})}},{key:"modalCancel",value:function(){this.setState({previewVisible:!1})}},{key:"normFile",value:function(e){return Array.isArray(e)?e:e&&e.fileList}},{key:"handImgChange",value:function(e){e.fileList.length?this.props.uploadImg(!1):this.props.uploadImg(!0),"error"==e.file.status&&V.a.error("很遗憾...这次上传失败了。")}},{key:"handleChangeChannels",value:function(e){console.log(e),this.props.changeSelectChannels(e)}},{key:"handleChangecolumn",value:function(e){var t=this.props.form.getFieldValue("channel_id");this.props.changeSelectcolumn({channel_id:t,column_id:e})}},{key:"handleEditor",value:function(e,t){W=t}},{key:"render",value:function(){var e={labelCol:{span:6},wrapperCol:{span:18}},t=z.a.createElement("div",null,z.a.createElement(F.a,{type:"plus"}),z.a.createElement("div",{className:"ant-upload-text"},"选择图片"));return z.a.createElement(b.a,null,z.a.createElement(b.a.Item,C()({label:"所属频道"},e),this.props.form.getFieldDecorator("channel_id",{initialValue:this.props.channel_id,rules:[{required:!0,message:"请选择所属频道!"}]})(z.a.createElement(I.a,{placeholder:"请选择",onChange:this.handleChangeChannels.bind(this)},this.props.selectChannels.map(function(e,t){return z.a.createElement(I.a.Option,{key:t,value:String(e.channel_id)},e.channel_name)})))),z.a.createElement(b.a.Item,C()({label:"所属栏目"},e),this.props.form.getFieldDecorator("column_id",{initialValue:this.props.column_id,rules:[{message:"请选择所属栏目!"}]})(z.a.createElement(I.a,{placeholder:"请先选择栏目"},this.props.selectColumns.map(function(e,t){return z.a.createElement(I.a.Option,{key:String(t),value:String(e.column_id)},e.column_name)})))),z.a.createElement(b.a.Item,C()({label:"提问用户"},e),this.props.form.getFieldDecorator("question_author",{initialValue:this.props.question_author,rules:[{required:!0,message:"请输入提问用户"}]})(z.a.createElement(v.a,{placeholder:"请输入提问用户"}))),z.a.createElement(b.a.Item,C()({label:"用户头像"},e),this.props.form.getFieldDecorator("user_img",{initialValue:this.props.user_img,valuePropName:"fileList",normalize:this.normFile,onChange:this.handImgChange.bind(this)})(z.a.createElement(h.a,{action:"http://up.qiniu.com/",data:{token:this.props.uploadToken,key:this.state.name,file:this.state.files},onPreview:this.handlePreview.bind(this),listType:"picture-card",beforeUpload:this.beforeUpload.bind(this)},this.props.isUpload?t:null))),z.a.createElement(c.a,{visible:this.state.previewVisible,footer:null,onCancel:this.modalCancel.bind(this)},z.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage})),z.a.createElement(b.a.Item,C()({label:"提问内容"},e),this.props.form.getFieldDecorator("intro",{initialValue:this.props.intro,rules:[{required:!0,message:"请输入提问内容!"}]})(z.a.createElement(v.a,{type:"textarea",rows:4,maxLength:200,placeholder:"请输入提问内容"}))),z.a.createElement(b.a.Item,C()({},e,{label:"回复内容",hasFeedback:!0}),this.props.form.getFieldDecorator("editor1")(z.a.createElement(R.a,{html:W,handleEditor:this.handleEditor}))),z.a.createElement(b.a.Item,C()({},e,{label:"推荐到首页",required:!0}),this.props.form.getFieldDecorator("is_reco",{rules:[{required:!0,message:"请选择状态"}],initialValue:this.props.is_reco})(z.a.createElement(s.a.Group,null,z.a.createElement(s.a,{value:"1"},"是"),z.a.createElement(s.a,{value:"2"},"否")))),z.a.createElement(b.a.Item,C()({label:"排序"},e),this.props.form.getFieldDecorator("sort_order",{initialValue:this.props.sort_order,rules:[{required:!0,message:"请输入排序!",pattern:/^[0-9]*[1-9][0-9]*$/}]})(z.a.createElement(v.a,{placeholder:"请输入排序"}))),z.a.createElement(b.a.Item,{wrapperCol:{span:22,offset:3}},z.a.createElement(i.a,{type:"primary",onClick:this.handleSubmit.bind(this),loading:this.props.formSureButton},"提交"),z.a.createElement(i.a,{type:"ghost",style:{marginLeft:"30px"},onClick:this.handleCancel.bind(this)},"返回")))}}]),InformationAdd}(z.a.Component);G=b.a.create({})(G),t.a=G}});