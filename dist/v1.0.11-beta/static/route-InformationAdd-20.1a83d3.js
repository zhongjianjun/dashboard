webpackJsonp([20],{576:function(e,t,a){"use strict";function InformationAdd(e){var t=e.dispatch,n=e.information,r=e.app,o={breadcrumbs:[{name:"首页"},{name:"资讯管理"},{name:"新增资讯"}]},s={selectChannels:r.selectChannels,selectColumns:r.selectColumns,labellist:n.labellist,uploadToken:n.uploadToken,isUpload:n.isUpload,formSureButton:n.formSureButton,channel_id:n.channel_id,column_id:n.column_id,image:n.image,intro:n.intro,is_reco:n.is_reco,keywords:n.keywords,label_ids:n.label_ids,name:n.name,shows:n.shows,sort_order:n.sort_order,summary:n.summary,changeSelectChannels:function(e){t(a.i(p.d)(e)),t(a.i(h.e)(e)),a.i(m.a)(function(){return t(a.i(h.a)({channel_id:e,column_id:"0"}))})},changeSelectcolumn:function(e){a.i(m.a)(function(){return t(a.i(h.a)(e))})},uploadImg:function(e){t(a.i(h.b)(e))},onCancel:function(){u.b.push("/information")},onOk:function(e){a.i(m.a)(function(){return t(a.i(h.f)(e))})}};return l.a.createElement("div",null,l.a.createElement(c.a,o),l.a.createElement(i.a,{className:"y-m-b-40"},l.a.createElement(d.a,s)))}Object.defineProperty(t,"__esModule",{value:!0});var n=a(599),r=(a.n(n),a(598)),i=a.n(r),o=a(0),l=a.n(o),s=a(135),m=a(242),p=(a(12),a(49)),c=a(594),u=a(35),d=a(638),h=a(136);t.default=a.i(s.a)(function(e){return{information:e.information,app:e.app}})(InformationAdd)},594:function(e,t,a){"use strict";function newBreadcrumb(e){var t=e.breadcrumbs;return l.a.createElement(i.a,{separator:">",style:{marginBottom:"20px"}},t.map(function(e,t){return l.a.createElement(i.a.Item,{key:t},m.a.isStringNotEmpty(e.href)?l.a.createElement(s.Link,{to:e.href},e.name):e.name)}))}var n=a(605),r=(a.n(n),a(604)),i=a.n(r),o=a(0),l=a.n(o),s=a(73),m=a(12);t.a=newBreadcrumb},613:function(e,t,a){"use strict";var n=a(240),r=a.n(n),i=a(29),o=a.n(i),l=a(241),s=a.n(l),m=a(31),p=a.n(m),c=a(30),u=a.n(c),d=a(0),h=a.n(d),f=a(139),g=a(615),v=(a.n(g),a(4)),E=a(626),b=(a.n(E),void 0),_=function(e){function Editor(e){o()(this,Editor);var t=p()(this,(Editor.__proto__||r()(Editor)).call(this,e));return t.state={},t}return u()(Editor,e),s()(Editor,[{key:"componentDidMount",value:function(){var e=this,t=this.props.id;b=new wangEditor(t),b.config.menus=wangEditor.config.menus.map(function(e,t){return"video"===e?null:"location"===e?null:"insertcode"===e?null:e}),b.config.uploadImgUrl=a.i(v.b)()+"/property/image/upload",b.config.withCredentials=!1,b.create();var n=b;b.$txt.html(this.props.html),b.onchange=function(){var a=n.$txt.html();e.props.handleEditor(t,a)}}},{key:"componentWillReceiveProps",value:function(e){var t=this,a=this.props.id,n=b;b.$txt.html(e.html),b.onchange=function(){var e=n.$txt.html();t.props.handleEditor(a,e)}}},{key:"render",value:function(){var e={width:"100%",height:"200px"};return h.a.createElement("div",null,h.a.createElement("div",{id:this.props.id,style:e,contentEditable:"true"}))}}]),Editor}(h.a.Component);t.a=a.i(f.connect)(function(e){return{editor:e.editor}})(_)},614:function(e,t,a){t=e.exports=a(41)(!1),t.push([e.i,"",""])},615:function(e,t,a){var n=a(614);"string"==typeof n&&(n=[[e.i,n,""]]);a(42)(n,{});n.locals&&(e.exports=n.locals)},638:function(e,t,a){"use strict";var n=a(133),r=(a.n(n),a(90)),i=a.n(r),o=a(607),l=(a.n(o),a(606)),s=a.n(l),m=a(610),p=(a.n(m),a(609)),c=a.n(p),u=a(593),d=(a.n(u),a(597)),h=a.n(d),f=a(596),g=(a.n(f),a(595)),v=a.n(g),E=a(1),b=a.n(E),_=a(134),y=(a.n(_),a(43)),k=a.n(y),w=a(601),C=(a.n(w),a(600)),I=a.n(C),F=a(14),S=(a.n(F),a(13)),D=a.n(S),x=a(240),V=a.n(x),A=a(29),U=a.n(A),q=a(241),P=a.n(q),B=a(31),j=a.n(B),L=a(30),O=a.n(L),$=a(0),T=a.n($),M=(a(136),a(613)),N=[],z="",R=function(e){function InformationAdd(e){U()(this,InformationAdd);var t=j()(this,(InformationAdd.__proto__||V()(InformationAdd)).call(this,e));return t.state={name:"",file:"",previewImage:"",previewVisible:"",isUpload:!0},t.props.img_url,z=t.props.intro,t}return O()(InformationAdd,e),P()(InformationAdd,[{key:"componentDidMount",value:function(){}},{key:"handleSubmit",value:function(){var e=this;this.props.form.validateFields(function(t,a){if(!t){var n="";0!=a.image.length&&(void 0!=a.image[0].response?n=a.image[0].response.data.imgPath+a.image[0].response.data.message:""!=a.image&&(n=a.image[0].url));var r=e.props.id,i="";if(z=z.replace(new RegExp("<p><br></p>"),""),i=z,""==z)return D.a.error("资讯内容不能为空"),!1;e.props.onOk({id:r,image:n,channel_id:a.channel_id,column_id:a.column_id,intro:i,is_reco:a.is_reco,keywords:a.keywords,label_ids:a.label_ids,name:a.name,shows:a.shows,sort_order:a.sort_order,summary:a.summary},e.props.form.resetFields)}})}},{key:"handleCancel",value:function(){this.props.onCancel(),this.props.form.resetFields(),this.setState({isUpload:!0})}},{key:"handlePreview",value:function(e){this.setState({previewImage:e.url||e.thumbUrl,previewVisible:!0})}},{key:"beforeUpload",value:function(e){var t="image/jpeg"===e.type,a="image/png"===e.type;if("image/jpg"!==e.type&&!t&&!a)return D.a.error("只能上传.jpeg,.jpg,.png图片"),!1;if(!(e.size/1024/1024<2))return D.a.error("请上传小于 2MB 的图片!"),!1;var n=(new Date).getTime(),r=e.type.split("/");this.setState({name:"jiazhuanghoutai/"+n+"."+r[1],files:e})}},{key:"normFile",value:function(e){return Array.isArray(e)?e:e&&e.fileList}},{key:"handImgChange",value:function(e){e.fileList.length?this.props.uploadImg(!1):this.props.uploadImg(!0),"error"==e.file.status&&D.a.error("很遗憾...这次上传失败了。")}},{key:"handleChangeChannels",value:function(e){this.props.form.resetFields(["column_id","label_ids"]),this.props.changeSelectChannels(e)}},{key:"handleChangecolumn",value:function(e){var t=this.props.form.getFieldValue("channel_id");this.props.form.resetFields(["label_ids"]),this.props.changeSelectcolumn({channel_id:t,column_id:e})}},{key:"componentWillReceiveProps",value:function(e){this.props.intro!=e.intro&&(z=e.intro),N=[],e.labellist.map(function(e,t){return N.push(T.a.createElement(I.a.Option,{key:t,value:String(e.id)},e.name))})}},{key:"handleEditor",value:function(e,t){z=t}},{key:"render",value:function(){console.log(this.props.isUpload,1111);var e={labelCol:{span:6},wrapperCol:{span:18}},t=T.a.createElement("div",null,T.a.createElement(k.a,{type:"plus"}),T.a.createElement("div",{className:"ant-upload-text"},"选择图片"));return T.a.createElement(v.a,null,T.a.createElement(v.a.Item,b()({label:"所属频道"},e),this.props.form.getFieldDecorator("channel_id",{initialValue:this.props.channel_id,rules:[{required:!0,message:"请选择所属频道!"}]})(T.a.createElement(I.a,{placeholder:"请选择",onChange:this.handleChangeChannels.bind(this)},this.props.selectChannels.map(function(e,t){return T.a.createElement(I.a.Option,{key:t,value:String(e.channel_id)},e.channel_name)})))),T.a.createElement(v.a.Item,b()({label:"所属栏目"},e),this.props.form.getFieldDecorator("column_id",{initialValue:this.props.column_id,rules:[{message:"请选择所属栏目!"}]})(T.a.createElement(I.a,{placeholder:"请先选择栏目",onChange:this.handleChangecolumn.bind(this)},this.props.selectColumns.map(function(e,t){return T.a.createElement(I.a.Option,{key:String(t),value:String(e.column_id)},e.column_name)})))),T.a.createElement(v.a.Item,b()({label:"关联标签"},e),this.props.form.getFieldDecorator("label_ids",{initialValue:this.props.label_ids})(T.a.createElement(I.a,{mode:"multiple",placeholder:"请先选择栏目"},N))),T.a.createElement(v.a.Item,b()({label:"资讯标题"},e),this.props.form.getFieldDecorator("name",{initialValue:this.props.name,rules:[{required:!0,message:"请输入资讯标题"}]})(T.a.createElement(h.a,{placeholder:"请输入资讯标题"}))),T.a.createElement(v.a.Item,b()({label:"资讯主图"},e),this.props.form.getFieldDecorator("image",{initialValue:this.props.image,valuePropName:"fileList",normalize:this.normFile,onChange:this.handImgChange.bind(this),rules:[{required:!0,message:"请上传资讯主图!"}]})(T.a.createElement(c.a,{action:"http://up.qiniu.com/",data:{token:this.props.uploadToken,key:this.state.name,file:this.state.files},onPreview:this.handlePreview.bind(this),listType:"picture-card",beforeUpload:this.beforeUpload.bind(this)},this.props.isUpload?t:null))),T.a.createElement(v.a.Item,b()({label:"资讯摘要"},e),this.props.form.getFieldDecorator("summary",{initialValue:this.props.summary,rules:[{required:!0,message:"请输入资讯摘要!"}]})(T.a.createElement(h.a,{type:"textarea",rows:4,maxLength:200,placeholder:"请输入资讯摘要"}))),T.a.createElement(v.a.Item,b()({},e,{label:"资讯内容",hasFeedback:!0,required:!0}),this.props.form.getFieldDecorator("editor1")(T.a.createElement(M.a,{html:z,handleEditor:this.handleEditor}))),T.a.createElement(v.a.Item,b()({label:"浏览量"},e),this.props.form.getFieldDecorator("shows",{initialValue:this.props.shows,rules:[{message:"请输入浏览量!",pattern:/^[0-9]*[1-9][0-9]*$/}]})(T.a.createElement(h.a,{placeholder:"请输入浏览量"}))),T.a.createElement(v.a.Item,b()({label:"关键词"},e),this.props.form.getFieldDecorator("keywords",{initialValue:this.props.keywords,rules:[{message:"请输入关键词!"}]})(T.a.createElement(h.a,{placeholder:"请输入关键词"}))),T.a.createElement(v.a.Item,b()({},e,{label:"推荐到首页",required:!0}),this.props.form.getFieldDecorator("is_reco",{rules:[{required:!0,message:"请选择状态"}],initialValue:this.props.is_reco})(T.a.createElement(s.a.Group,null,T.a.createElement(s.a,{value:"1"},"是"),T.a.createElement(s.a,{value:"2"},"否")))),T.a.createElement(v.a.Item,b()({label:"排序"},e),this.props.form.getFieldDecorator("sort_order",{initialValue:this.props.sort_order,rules:[{required:!0,message:"请输入排序!",pattern:/^[0-9]*[1-9][0-9]*$/}]})(T.a.createElement(h.a,{placeholder:"请输入排序"}))),T.a.createElement(v.a.Item,{wrapperCol:{span:22,offset:3}},T.a.createElement(i.a,{type:"primary",onClick:this.handleSubmit.bind(this),loading:this.props.formSureButton},"提交"),T.a.createElement(i.a,{type:"ghost",style:{marginLeft:"30px"},onClick:this.handleCancel.bind(this)},"返回")))}}]),InformationAdd}(T.a.Component);R=v.a.create({})(R),t.a=R}});